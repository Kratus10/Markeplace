# This script will forcefully remove node_modules and do a clean install
Write-Host "Stopping all node processes..."
Get-Process node -ErrorAction SilentlyContinue | Stop-Process -Force -ErrorAction SilentlyContinue

Write-Host "Removing node_modules..."
Remove-Item -Recurse -Force node_modules -ErrorAction SilentlyContinue

# Retry removal of problematic directories
$problemPaths = @(
    "node_modules\.prisma\client",
    "node_modules\@next"
)

foreach ($path in $problemPaths) {
    if (Test-Path $path) {
        Write-Host "Removing problematic path: $path"
        Remove-Item -Recurse -Force $path -ErrorAction SilentlyContinue
    }
}

Write-Host "Reinstalling dependencies..."
npm install --force

Write-Host "Resetting Prisma client..."
npx prisma generate --force

Write-Host "Operation completed successfully!"
